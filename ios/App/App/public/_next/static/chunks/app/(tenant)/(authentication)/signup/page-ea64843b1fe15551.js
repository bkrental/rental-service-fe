(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[117],{71994:function(e,n,a){Promise.resolve().then(a.bind(a,45787))},45787:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return p}});var r=a(3827),t=a(37732),s=a(32726),o=a(31963),u=a(17540),i=a(28044),c=a(75504),l=a(3537),m=a(8792),d=a(64090),h=a(30828);function p(){let e=(0,h.I0)(),[n]=(0,o.Bl)(),a=(0,s.Z)(),p=async(r,t)=>{let{setSubmitting:s,setFieldError:o}=t;try{let t=await n(r).unwrap();s(!1),e((0,u.ps)(t.data)),a()}catch(e){console.log(e),o("password",e.data.message)}};return(0,r.jsx)(d.Suspense,{children:(0,r.jsxs)("div",{className:"auth_form-container",children:[(0,r.jsx)(l.J9,{initialValues:{name:"",phone:"",email:"",password:""},onSubmit:p,validationSchema:i.J,validateOnChange:!1,validateOnMount:!1,children:e=>{let{isSubmitting:n,errors:a}=e;return(0,r.jsxs)(l.l0,{className:"auth_form",children:[(0,r.jsx)(l.gN,{className:(0,c.Z)("auth_form-input",a.name&&"auth_form-input--error"),name:"name",placeholder:"Enter your name*"}),(0,r.jsx)(l.Bc,{className:"auth_form-message auth_form-message--error",name:"name",component:"p"}),(0,r.jsx)(l.gN,{className:(0,c.Z)("auth_form-input",a.phone&&"auth_form-input--error"),name:"phone",placeholder:"Phone Number*"}),(0,r.jsx)(l.Bc,{className:"auth_form-message auth_form-message--error",name:"phone",component:"p"}),(0,r.jsx)(l.gN,{className:(0,c.Z)("auth_form-input",a.email&&"auth_form-input--error"),name:"email",placeholder:"Email*"}),(0,r.jsx)(l.Bc,{className:"auth_form-message auth_form-message--error",name:"email",component:"p"}),(0,r.jsx)(l.gN,{className:(0,c.Z)("auth_form-input",a.password&&"auth_form-input--error"),type:"password",name:"password",placeholder:"Password*"}),(0,r.jsx)(l.Bc,{className:"auth_form-message auth_form-message--error",name:"password",component:"p"}),(0,r.jsx)(t.Z,{loading:n,children:"Sign Up"})]})}}),(0,r.jsxs)("p",{children:["Already have an account ",(0,r.jsx)(m.default,{href:"/login",children:"Login"})]})]})})}},37732:function(e,n,a){"use strict";a.d(n,{Z:function(){return o}});var r=a(3827),t=a(75504),s=a(56181);function o(e){let{loading:n,children:a,...o}=e;return(0,r.jsx)("button",{className:(0,t.Z)("auth_submit-btn",n&&"auth_submit-btn--loading"),type:"submit",children:n?(0,r.jsx)(s.Z,{loading:n,color:"#000",size:20}):a})}},32726:function(e,n,a){"use strict";a.d(n,{Z:function(){return t}});var r=a(47907);function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=(0,r.useRouter)(),a=(0,r.useSearchParams)().get("returnURL");return()=>{n.push(a||e)}}},14342:function(e,n,a){"use strict";a.d(n,{g:function(){return i}});var r=a(27230),t=a(43741),s=a(17540);let o=(0,r.ni)({baseUrl:"http://localhost:3000",prepareHeaders:(e,n)=>{let{getState:a}=n,r=a().auth.accessToken;return r&&e.set("Authorization","Bearer ".concat(r)),e}}),u=async(e,n,a)=>{var r;let t=await o(e,n,a);if((null==t?void 0:null===(r=t.error)||void 0===r?void 0:r.originalStatus)===401){console.log("sending refresh token");let r=await o("/auth/refresh",n,a);console.log("refreshResult",r),(null==r?void 0:r.data)?(n.dispatch((0,s.ps)({...auth,accessToken:r.data.accessToken})),t=await o(e,n,a)):(console.log("refresh failed"),n.dispatch((0,s.TT)()))}return t},i=(0,t.LC)({baseQuery:u,endpoints:e=>({})})},31963:function(e,n,a){"use strict";a.d(n,{Bl:function(){return t},YA:function(){return r}});let{useLoginMutation:r,useSignupMutation:t}=a(14342).g.injectEndpoints({endpoints:e=>({login:e.mutation({query:e=>({url:"/auth/login",method:"POST",body:{...e}})}),signup:e.mutation({query:e=>({url:"/auth/signup",method:"POST",body:{...e}})})})})},17540:function(e,n,a){"use strict";a.d(n,{TT:function(){return s},he:function(){return o},ps:function(){return t}});let r=(0,a(46608).oM)({name:"auth",initialState:{accessToken:null,user:null,isAuthenticated:!1},reducers:{loginSuccess:(e,n)=>{e.accessToken=n.payload.access_token,e.user=n.payload.user,e.isAuthenticated=!0},setUserInfo:(e,n)=>{e.accessToken=n.payload.access_token,e.user=n.payload.user,e.isAuthenticated=!0},removeUserInfo:(e,n)=>{localStorage.removeItem("accessToken"),e.isAuthenticated=!1,e.user=null,e.accessToken=null}}}),{setUserInfo:t,removeUserInfo:s,loginSuccess:o}=r.actions;n.ZP=r.reducer},28044:function(e,n,a){"use strict";a.d(n,{J:function(){return s},d:function(){return t}});var r=a(41991);let t=(0,r.Ry)({phone:(0,r.Z_)().required("Please enter your phone number"),password:(0,r.Z_)().required("Please enter your password")}),s=(0,r.Ry)({name:(0,r.Z_)().required("Please enter your name"),phone:(0,r.Z_)().matches(/(\+84|84|0[3|5|7|8|9])+([0-9]{8})\b/g,"Phone number must be a Vietnamese phone number.\n Ex: 0828696919 or +84828696919").required("Please enter your phone number"),email:(0,r.Z_)().email("Invalid email format").required("Please enter your email"),password:(0,r.Z_)().min(8,"Password must have at least 8 characters").required("Please enter your password")})}},function(e){e.O(0,[665,792,741,807,971,69,744],function(){return e(e.s=71994)}),_N_E=e.O()}]);